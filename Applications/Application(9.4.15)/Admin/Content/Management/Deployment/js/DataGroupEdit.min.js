function DataGroupEditPage(n){function i(n){return n&&!!n.value}function r(n){return n.value.match(f)}function e(n){var i=t.getElementsByTagName("td");i[0].update(n.Name);i[1].update(n.Id)}function o(n){var r=document.getElementById("ListTable"),u,i,t;s(r);u=r.rows.length;i=r.insertRow(u);i.id=n.Id;i.setAttribute("itemID",n.Id);i.setAttribute("style","cursor:pointer;");i.setAttribute("class","listRow");t=i.insertCell(-1);t.update(n.Name);t.setAttribute("onclick","currentPage.editDataItem(this);");t.setAttribute("style","width: auto");t=i.insertCell(-1);t.update(n.Id);t.setAttribute("onclick","currentPage.editDataItem(this);");t.setAttribute("style","width: auto");t=i.insertCell(-1);t.update("<i class='fa fa-remove color-danger'><\/i>");t.setAttribute("onclick","currentPage.deleteDataItem(this);");t.setAttribute("style","width: auto");t=i.insertCell(-1)}function s(n){var i=n.rows.length,t;i==2&&(t=n.rows[1].getElementsByClassName("infobar"),t.length>0&&(n.rows[1].style.display="none"))}function h(n,t,i,r){var u=document.createElement("form"),f,e;if(u.action=t,u.method=n,u.target=r||"_self",i)for(f in i)e=document.createElement("input"),e.setAttribute("type","hidden"),e.name=f,e.value=typeof i[f]=="object"?JSON.stringify(i[f]):i[f],u.appendChild(e);u.style.display="none";document.body.appendChild(u);u.submit()}function c(n,t){var i,u,r;t=t||document.forms[0];for(i in n)u=document.getElementById(i),u||(r=document.createElement("input"),r.setAttribute("type","hidden"),r.name=i,t.appendChild(r),u=r),u.value=typeof n[i]=="object"?JSON.stringify(n[i]):n[i];return t}var t=null,f=/[^a-zA-Z0-9_]/,u={initialize:function(n){var t=this,r,i;t.originalId=n.Id;t.parentId=n.ParentId;t.dataItemTypes=n.DataItemTypes;t.labels=n.Labels;t.actions=n.Actions;t.icon=n.Icon;t.iconColor=n.IconColor;t.selectIcon();Event.observe($("dlgIconSettings").select("#IconColorSelect")[0],"change",function(n){var i=n.target.value,r=$("dlgIconSettings").select("div.icon-block");r.forEach(function(n){var t=n.select("i")[0].classList;t.length>3&&t.remove(t[t.length-1]);t.add(i)});t.iconColor=i});r=$("dlgIconSettings").select("div.icon-block");r.forEach(function(n){Event.observe(n,"click",function(){$("dlgIconSettings").select('div[class="icon-block selected"]')[0].className="icon-block";this.classList.add("selected");t.icon=this.select("span")[0].textContent;t.selectIcon()})});Event.observe($("IconSearch"),"keyup",i);i=function(n){var t=n.target.value.toLowerCase();r.forEach(function(n){!t||n.select("span")[0].textContent.toLowerCase().indexOf(t)>-1?n.show():n.hide()})};Event.observe($("IconSearch"),"change",i);Event.observe($("IconSearch"),"keyup",i)},addDataItem:function(){t=null;dialog.show("DataItemDetailsDialog","/Admin/Content/Management/Deployment/DataItemTypeEdit.aspx")},editDataItem:function(n){t=n.closest("tr");var i=t.attributes.itemid.value;h("POST","/Admin/Content/Management/Deployment/DataItemTypeEdit.aspx?dataItemTypeId="+encodeURIComponent(i),{dataItemTypeRaw:this.dataItemTypes[i]},"DataItemDetailsDialogFrame");dialog.show("DataItemDetailsDialog")},deleteDataItem:function(n){if(confirm(this.labels.deleteMessage)){var t=n.closest("tr"),i=t.attributes.itemid.value;t.parentNode.removeChild(t);delete this.dataItemTypes[i]}},onDataItemEditOk:function(){if(this.validateDataItem()){var r=document.getElementById("DataItemDetailsDialogFrame"),n=r.window||r.contentWindow,u=n.getParametersFromContainer(n.document),i={Id:n.document.getElementById("dataItemTypeId").value,Name:n.document.getElementById("dataItemTypeName").value,Provider:n.document.getElementById("Dynamicweb.Deployment.DataItemProvider_AddInTypes").value,Parameters:u},f=n.document.getElementById("dataItemTypeOriginalId").value||n.document.getElementById("dataItemTypeId").value;t?e(i):o(i);this.dataItemTypes[f]=i;dialog.hide("DataItemDetailsDialog")}},validateDataItem:function(){var e=!1,t=this,o=document.getElementById("DataItemDetailsDialogFrame"),u=o.window||o.contentWindow;dwGlobal.hideAllControlsErrors(u.document);var f=u.document.getElementById("dataItemTypeName"),n=u.document.getElementById("dataItemTypeId"),s=u.document.getElementById("Dynamicweb.Deployment.DataItemProvider_AddInTypes");return i(f)?i(n)?r(n)?(dwGlobal.showControlErrors(n,t.labels.invalidIdCharacters),n.focus()):i(s)?e=!0:(alert(t.labels.emptyProvider),s.focus()):(dwGlobal.showControlErrors(n,t.labels.emptyId),n.focus()):(dwGlobal.showControlErrors(f,t.labels.emptyName),f.focus()),e},save:function(){var n=this;this.validateDataGroup(function(){c({cmd:"save",parentGroupId:n.parentId,dataItemTypes:n.dataItemTypes,Icon:n.icon,IconColor:n.iconColor});var t=document.getElementById("cmdSubmit");t.click()})},validateDataGroup:function(n){var o=!1,u=this,f,t,e;return dwGlobal.hideAllControlsErrors(),f=document.getElementById("dataGroupName"),t=document.getElementById("dataGroupId"),i(f)?i(t)?r(t)?(dwGlobal.showControlErrors(t,u.labels.invalidIdCharacters),t.focus()):(o=!0,u.originalId?n():(e=u.actions.checkExistingId,e.OnSuccess.Function=function(){n()},e.OnFail.Function=function(){dwGlobal.showControlErrors(t,u.labels.existingId);t.focus()},Action.Execute(e,{dataGroupId:t.value}))):(dwGlobal.showControlErrors(t,u.labels.emptyId),t.focus()):(dwGlobal.showControlErrors(f,u.labels.emptyName),f.focus()),o},cancel:function(){var n=this;location.href="DeploymentConfiguration.aspx?dataGroupId="+(n.id||n.parentId)},selectIcon:function(){var n=document.getElementById("IconSelector");n.className=$("dlgIconSettings").select('div[class="icon-block selected"]')[0].select("i")[0].className;n.title=n.className;n.style.display=this.icon==="None"||!this.icon?"none":"";dialog.hide("dlgIconSettings")}};return u.initialize(n),u}function IdFromNameGenerator(n,t,i){function u(n){var t=n;if(t&&t.length){for(t=t.replace(/[^0-9a-zA-Z_\s]/gi,"_");t.indexOf("_")==0;)t=t.substr(1);t=t.replace(/\s+/g," ");t=t.replace(/\s([a-z])/g,function(n,t){return t.toUpperCase()});t=t.replace(/\s/g,"_");t=t.length>1?t.substr(0,1).toUpperCase()+t.substr(1):t.toUpperCase()}return t}function f(){var i=u(t.value);return n.value==i}function e(){r=f()}function o(){r&&t.value&&t.value.length&&(n.value=u(t.value))}function s(){r=n&&t&&(!n.value||!n.value.length);i&&!r&&(r=f());r&&(t.addEventListener("keyup",o),n.addEventListener("blur",e))}var r=!1;s()}