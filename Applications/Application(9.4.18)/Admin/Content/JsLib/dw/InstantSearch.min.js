if("undefined"==typeof Dynamicweb)var Dynamicweb={};"undefined"==typeof Dynamicweb.Frontend&&(Dynamicweb.Frontend={});Dynamicweb.Frontend.Hashtable=function(){this._data={}};Dynamicweb.Frontend.Hashtable.prototype.get_data=function(){return this._data};Dynamicweb.Frontend.Hashtable.prototype.get=function(a){return this._data[a]};Dynamicweb.Frontend.Hashtable.prototype.contains=function(a){var b=null,c=false;if(a){b=this.get(a);(c=b!=null)&&typeof b.toLowerCase!="undefined"&&(c=b.length>0)}return c};
Dynamicweb.Frontend.Hashtable.prototype.set=function(a,b){this._data[a]=b};Dynamicweb.Frontend.Hashtable.prototype.merge=function(a){if(a){typeof a.get_data=="function"&&a.get_data();for(var b in a)typeof a[b]!="function"&&!this._data[b]&&this.set(b,a[b])}};Dynamicweb.Frontend.Document=function(){};Dynamicweb.Frontend.Document.Current=new Dynamicweb.Frontend.Document;Dynamicweb.Frontend.Document._offset=function(){};
Dynamicweb.Frontend.Document._offset.initialize=function(){var a=document.body,b=document.createElement("div"),c=document.createElement("div"),d=null,e=null,f=null,g=parseFloat(jQuery.css(a,"marginTop"))||0;Dynamicweb.Frontend.Document.Current.style(b,{position:"absolute",top:"0px",left:"0px",margin:"0px",border:"0px",width:"1px",height:"1px",visibility:"hidden"});b.innerHTML='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0"><tr><td></td></tr></table>';
c.style.width=c.style.paddingLeft="1px";a.appendChild(c);a.insertBefore(b,a.firstChild);Dynamicweb.Frontend.Document._offset.boxModel=c.offsetWidth===2;d=b.firstChild;e=d.firstChild;f=d.nextSibling.firstChild.firstChild;Dynamicweb.Frontend.Document._offset.doesNotAddBorder=e.offsetTop!==5;Dynamicweb.Frontend.Document._offset.doesAddBorderForTableAndCells=f.offsetTop===5;e.style.position="fixed";e.style.top="20px";Dynamicweb.Frontend.Document._offset.supportsFixedPosition=e.offsetTop===20||e.offsetTop===
15;e.style.position=e.style.top="";d.style.overflow="hidden";d.style.position="relative";Dynamicweb.Frontend.Document._offset.subtractsBorderForOverflowNotVisible=e.offsetTop===-5;Dynamicweb.Frontend.Document._offset.doesNotIncludeMarginInBodyOffset=a.offsetTop!==g;a.removeChild(b);a.removeChild(c);a=b=d=e=f=null;Dynamicweb.Frontend.Document._offset.initialize=function(){}};
Dynamicweb.Frontend.Document._offset.getWindow=function(a){var b=null;a&&(typeof a.setInterval!="undefined"?b=a:a.nodeType==9&&(b=a.defaultView||a.parentWindow));return b};
Dynamicweb.Frontend.Document._offset.offset=function(a){var b=null,c={top:0,left:0},d=null,e=null,f=/^t(?:able|d|h)$/i,g=null,i=d=e=null,j=null,l=null,i=g=i=d=null;if("getBoundingClientRect"in document.documentElement){if(a&&a!==a.ownerDocument.body){try{b=a.getBoundingClientRect()}catch(k){}d=a.ownerDocument;e=d.documentElement;j=d.body;l=Dynamicweb.Frontend.Document._offset.getWindow(d);d=e.clientTop||j.clientTop||0;i=e.clientLeft||j.clientLeft||0;g=l.pageYOffset||Dynamicweb.Frontend.Document._offset.boxModel&&
e.scrollTop||j.scrollTop;e=l.pageXOffset||Dynamicweb.Frontend.Document._offset.boxModel&&e.scrollLeft||j.scrollLeft;c.top=b.top+g-d;c.left=b.left+e-i}}else{Dynamicweb.Frontend.Document._offset.initialize();g=a.offsetParent;d=a.ownerDocument;i;e=d.documentElement;j=d.body;i=(d=d.defaultView)?d.getComputedStyle(a,null):a.currentStyle;c.top=a.offsetTop;for(c.left=a.offsetLeft;(a=a.parentNode)&&a!==j&&a!==e;){if(Dynamicweb.Frontend.Document._offset.supportsFixedPosition&&i.position==="fixed")break;i=
d?d.getComputedStyle(a,null):a.currentStyle;c.top=c.top-a.scrollTop;c.left=c.left-a.scrollLeft;if(a===g){c.top=c.top+a.offsetTop;c.left=c.left+a.offsetLeft;if(Dynamicweb.Frontend.Document._offset.doesNotAddBorder&&(!Dynamicweb.Frontend.Document._offset.doesAddBorderForTableAndCells||!f.test(a.nodeName))){c.top=c.top+(parseFloat(i.borderTopWidth)||0);c.left=c.left+(parseFloat(i.borderLeftWidth)||0)}g=a.offsetParent}if(Dynamicweb.Frontend.Document._offset.subtractsBorderForOverflowNotVisible&&i.overflow!==
"visible"){c.top=c.top+(parseFloat(i.borderTopWidth)||0);c.left=c.left+(parseFloat(i.borderLeftWidth)||0)}}if(i.position==="relative"||i.position==="static"){c.top=c.top+j.offsetTop;c.left=c.left+j.offsetLeft}if(Dynamicweb.Frontend.Document._offset.supportsFixedPosition&&i.position==="fixed"){c.top=c.top+Math.max(e.scrollTop,j.scrollTop);c.left=c.left+Math.max(e.scrollLeft,j.scrollLeft)}}return c};
Dynamicweb.Frontend.Document.prototype.get_url=function(){var a=location.href,b=a.indexOf("#");b>=0&&(a=a.substring(0,b));return a=a+((a.indexOf("?")>0?"&":"?")+"t="+(new Date).getTime())};Dynamicweb.Frontend.Document.prototype.get_isIE=function(){var a=false;if(typeof Prototype!="undefined")a=Prototype.Browser.IE;else if(typeof jQuery!="undefined")a=jQuery.browser.msie;return a};
Dynamicweb.Frontend.Document.prototype.error=function(a){var b=null;if(typeof Error!="undefined"){b=Error();b.message=a;b.description=a;throw b;}throw a;};Dynamicweb.Frontend.Document.prototype.tag=function(a){var b="";if(a){a.tagName?b=a.tagName:a.nodeName?b=a.nodeName:a.length&&a.length>0&&(b=this.tag(a[0]));b&&(b=b.toLowerCase())}return b};
Dynamicweb.Frontend.Document.prototype.element=function(a){var b=null;typeof a=="string"?typeof jQuery!="undefined"?b=jQuery("#"+a):typeof Prototype!="undefined"&&(b=$(a)):b=typeof jQuery!="undefined"?jQuery(a):$(a);return b};Dynamicweb.Frontend.Document.prototype.id=function(a){var b=null;if(typeof a=="string")b=a;else if(a.id)b=a.id;else if(a.length&&a.length>0)b=a[0].id;return b};
Dynamicweb.Frontend.Document.prototype.addClass=function(a,b){(a=this.element(a))&&(a.addClassName?a.addClassName(b):a.addClass&&a.addClass(b))};Dynamicweb.Frontend.Document.prototype.removeClass=function(a,b){(a=this.element(a))&&(a.removeClassName?a.removeClassName(b):a.removeClass&&a.removeClass(b))};Dynamicweb.Frontend.Document.prototype.hasClass=function(a,b){var c=false;(a=this.element(a))&&(a.hasClassName?c=a.hasClassName(b):a.hasClass&&(c=a.hasClass(b)));return c};
Dynamicweb.Frontend.Document.prototype.attribute=function(a,b,c){var d="",a=this.element(a);if(b)if(typeof c=="undefined")a.attr?d=a.attr(b):a.readAttribute?d=a.readAttribute(b):a.getAttribute&&(d=a.getAttribute(b));else{d=c;a.attr?a.attr(b,c):a.writeAttribute?a.writeAttribute(b,c):a.setAttribute&&a.setAttribute(b,c)}typeof d=="undefined"&&(d="");return d};
Dynamicweb.Frontend.Document.prototype.offset=function(a){var b={top:0,left:0};(a=this.element(a))&&(typeof Prototype!="undefined"?b=Dynamicweb.Frontend.Document._offset.offset(a):a.offset&&(b=a.offset()));return b};Dynamicweb.Frontend.Document.prototype.width=function(a){return this.dimension(a,"Width",value)};Dynamicweb.Frontend.Document.prototype.height=function(a,b){return this.dimension(a,"Height",b)};
Dynamicweb.Frontend.Document.prototype.dimension=function(a,b,c){var d=0,e=null,f=null;if(a=this.element(a)){f=a;a.length&&a.length>0&&(f=a[0]);if(typeof c=="undefined")d=f["offset"+b];else{e={};e[b.toLowerCase()]=parseInt(c)+"px";this.style(f,e)}}return d};Dynamicweb.Frontend.Document.prototype.select=function(a,b){var c=[];a&&b&&(a.find?c=a.find(b):a.select&&(c=a.select(b)));return c};
Dynamicweb.Frontend.Document.prototype.next=function(a,b){var c=null;if((a=this.element(a))&&a.next){c=a.next(b);c!=null&&(c.length&&c.length>0)&&(c=c[0])}c&&(typeof c.length!="undefined"&&c.length==0)&&(c=null);return c};Dynamicweb.Frontend.Document.prototype.previous=function(a,b){var c=null;if(a=this.element(a)){a.prev?c=a.prev(b):a.previous&&(c=a.previous(b));c!=null&&(c.length&&c.length>0)&&(c=c[0])}c&&(typeof c.length!="undefined"&&c.length==0)&&(c=null);return c};
Dynamicweb.Frontend.Document.prototype.up=function(a,b,c){var d=null;if(a=this.element(a)){a.is&&a.is(b)?d=a:a.match&&a.match(b)&&(d=a);if(!d)if(a.up)d=a.up(b);else if(a.parent){d=c?a.parents(b):a.parent(b);d!=null&&(d.length&&d.length>0)&&(d=this.element(d[0]))}}return d};Dynamicweb.Frontend.Document.prototype.down=function(a,b){var c=null;if(a=this.element(a))if(a.down)c=a.down(b);else if(a.children){c=a.children(b);c!=null&&(c.length&&c.length>0)&&(c=this.element(c[0]))}return c};
Dynamicweb.Frontend.Document.prototype.style=function(a,b){var c="";(a=this.element(a))&&(typeof b=="string"?a.getStyle?c=a.getStyle(b):a.css&&(c=a.css(b)):a.setStyle?a.setStyle(b):a.css&&a.css(b));return c};Dynamicweb.Frontend.Document.prototype.clone=function(a,b){var c=null;(a=this.element(a))&&(c=a.clone(!!b));return c};Dynamicweb.Frontend.Document.prototype.append=function(a,b){(a=this.element(a))&&(a.appendChild?a.appendChild(b):a.append&&a.append(b))};
Dynamicweb.Frontend.Document.prototype.observe=function(a,b,c){if(a&&b&&c)if(typeof Event!="undefined"&&Event.observe)Event.observe(a,b,c);else{if(!a.bind)try{a=this.element(a)}catch(d){}a.bind&&a.bind(b,c)}};Dynamicweb.Frontend.Document.prototype.stopObserving=function(a,b,c){if(a&&b&&c)if(typeof Event!="undefined"&&Event.stopObserving)Event.stopObserving(a,b,c);else{if(!a.unbind)try{a=this.element(a)}catch(d){}a.unbind&&a.unbind(b,c)}};
Dynamicweb.Frontend.Document.prototype.eventTarget=function(a){var b=null;a&&(b=typeof Event!="undefined"&&Event.element?Event.element(a):a.target);return b};Dynamicweb.Frontend.Document.prototype.stopEvent=function(a){a&&(typeof Event!="undefined"&&Event.stop?Event.stop(a):a.stopPropagation&&a.stopPropagation())};
Dynamicweb.Frontend.Document.prototype.ready=function(a){Dynamicweb.Frontend.InstantSearch._checkFramework();typeof Event!="undefined"&&Event.observe?this.element(document).observe("dom:loaded",a):this.element(document).ready&&this.element(document).ready(a)};Dynamicweb.Frontend.Document.prototype.text=function(a){var b="";a&&(b=a.innerText?a.innerText:a.textContent);b||(b="");return b};
Dynamicweb.Frontend.Document.prototype.html=function(a,b){var c="";if(a)if(typeof jQuery!="undefined")if(typeof b=="undefined")c=this.element(a).html();else{c=b;this.element(a).html(b)}else if(typeof b=="undefined")c=a.innerHTML;else{c=b;a.innerHTML=b}c||(c="");return c};
Dynamicweb.Frontend.Document.prototype.value=function(a,b){var c="",d="",d="",e=[],f=null,g=null;if(a){d=this.tag(a);f=this.element(a);g=f.length&&f.length>0?f[0]:f;if(typeof b=="undefined")if(d=="input"){d=this.attribute(g,"type");e[0]=d=="button"||d=="submit"?this.attribute(f,"value"):d=="image"?this.attribute(f,"src"):g.value}else if(d=="select"){if(g.options&&g.options.length>0)if(g.multiple)for(f=0;f<g.options.length;f++){if(g.options[f].selected)e[e.length]=g.options[f].value}else if(g.selectedIndex>=
0&&g.selectedIndex<g.options.length)e[0]=g.options[g.selectedIndex].value}else{if(d=="textarea"||d=="button")e[0]=Dynamicweb.Frontend.Document.Current.text(g)}else if(d=="input"){d=this.attribute(g,"type");d=="button"||d=="submit"?this.attribute(f,"value",b):d=="image"?this.attribute(f,"src",b):g.value=b}else if(d=="select"){if(g.options&&g.options.length>0)for(f=0;f<g.options.length;f++)if(g.options[f].value==b){g.options[f].selected=true;if(!g.multiple)break}}else(d=="textarea"||d=="button")&&this.html(g,
b)}for(f=0;f<e.length;f++)if(e[f]){c=c+e[f];f<e.length-1&&(c=c+",")}return c};
Dynamicweb.Frontend.Document.prototype.data=function(a,b){var c="",d={},e={},f="data-dw";b||(b={});if(a)if(c=this.id(a)){if(!window._elementData)window._elementData=new Dynamicweb.Frontend.Hashtable;typeof b.suffix!="undefined"&&(f=f+("-"+b.suffix));d=window._elementData.get(c);if(typeof b.value=="undefined"){d&&(e=d.get(f));e==null&&(e={})}else{e=b.value;d==null&&(d=new Dynamicweb.Frontend.Hashtable);d.set(f,b.value);window._elementData.set(c,d)}}return e};
Dynamicweb.Frontend.Document.prototype.serializeForm=function(a){var b={},c=[];if(a=this.element(a))if(a.serializeArray){c=a.serializeArray();jQuery.each(c,function(){if(b[this.name]){b[this.name].push||(b[this.name]=[b[this.name]]);b[this.name].push(this.value||"")}else b[this.name]=this.value||""})}else a.serialize&&(b=a.serialize(true));return b};
Dynamicweb.Frontend.Document.prototype.deserialize=function(a){var b={};if(a&&typeof a=="string")try{a.evalJSON?b=a.evalJSON():typeof jQuery!="undefined"&&jQuery.parseJSON&&(b=jQuery.parseJSON(a))}catch(c){}return b};
Dynamicweb.Frontend.Document.prototype.postAsync=function(a,b){b||(b={});if(!b.parameters)b.parameters={};if(!b.onComplete)b.onComplete=function(){};a&&(typeof Ajax!="undefined"&&Ajax.Request?new Ajax.Request(a,{method:"post",parameters:b.parameters,onComplete:b.onComplete}):jQuery.ajax&&jQuery.ajax({type:"POST",url:a,data:b.parameters,complete:b.onComplete}))};
Dynamicweb.Frontend.SuggestionBox=function(a,b){this._e=Dynamicweb.Frontend.Document.Current.element(a);this._attachTo=Dynamicweb.Frontend.Document.Current.element(b);this._data=[];this._current=null;this._query="";this._emptyListTemplate=this._itemTemplate=null};Dynamicweb.Frontend.SuggestionBox.prototype.get_container=function(){return this._e};
Dynamicweb.Frontend.SuggestionBox.prototype.get_isVisible=function(){return Dynamicweb.Frontend.Document.Current.style(this.get_container(),"display").toLowerCase()!="none"};Dynamicweb.Frontend.SuggestionBox.prototype.get_itemTemplate=function(){return this._itemTemplate};Dynamicweb.Frontend.SuggestionBox.prototype.set_itemTemplate=function(a){this._itemTemplate=a};Dynamicweb.Frontend.SuggestionBox.prototype.get_emptyListTemplate=function(){return this._emptyListTemplate};
Dynamicweb.Frontend.SuggestionBox.prototype.set_emptyListTemplate=function(a){this._emptyListTemplate=a};Dynamicweb.Frontend.SuggestionBox.prototype.get_query=function(){return this._query};Dynamicweb.Frontend.SuggestionBox.prototype.set_query=function(a){this._query=a};Dynamicweb.Frontend.SuggestionBox.prototype.get_current=function(){return this._current};
Dynamicweb.Frontend.SuggestionBox.prototype.set_current=function(a){a&&(Dynamicweb.Frontend.Document.Current.hasClass(a,"dw-suggestion-item")||(a=Dynamicweb.Frontend.Document.Current.up(a,".dw-suggestion-item",true)));this._current!=null&&Dynamicweb.Frontend.Document.Current.removeClass(this._current,"dw-suggestion-item-active");this._current=a;this._current!=null&&Dynamicweb.Frontend.Document.Current.addClass(this._current,"dw-suggestion-item-active")};
Dynamicweb.Frontend.SuggestionBox.prototype.get_attachTo=function(){return this._attachTo};Dynamicweb.Frontend.SuggestionBox.prototype.set_attachTo=function(a){this._attachTo=a};Dynamicweb.Frontend.SuggestionBox.prototype.get_data=function(){if(!this._data)this._data=[];return this._data};
Dynamicweb.Frontend.SuggestionBox.prototype.populateResults=function(a,b){var c=this,d=null,e=this.get_container(),f=false;this._data=a;if(!this._data)this._data=[];b=b||function(){};Dynamicweb.Frontend.Document.Current.html(e,"");if(this._data.length==0)this.get_emptyListTemplate()&&Dynamicweb.Frontend.Document.Current.append(e,Dynamicweb.Frontend.Document.Current.clone(this.get_emptyListTemplate(),true));else if(this.get_itemTemplate())for(var f=this._data[0].ID&&this._data[0].ID.length,g=0;g<this._data.length;g++){d=
Dynamicweb.Frontend.Document.Current.clone(this.get_itemTemplate(),true);Dynamicweb.Frontend.Document.Current.html(d,f?this._data[g].Name:this._data[g]);f&&Dynamicweb.Frontend.Document.Current.attribute(d,"data-suggestion-text",this._data[g].Name);Dynamicweb.Frontend.Document.Current.observe(d,"click",function(a){c.set_current(Dynamicweb.Frontend.Document.Current.eventTarget(a));c.updateTextboxValue();c.hide();Dynamicweb.Frontend.InstantSearchSettings.Global.getIsEnabled(c.get_attachTo(),"search")&&
Dynamicweb.Frontend.InstantSearch._onInstantSearchWrapper(a,c.get_attachTo())});Dynamicweb.Frontend.Document.Current.observe(d,"mouseover",function(a){c.set_current(Dynamicweb.Frontend.Document.Current.eventTarget(a))});Dynamicweb.Frontend.Document.Current.observe(d,"mouseout",function(a){a=Dynamicweb.Frontend.Document.Current.eventTarget(a);Dynamicweb.Frontend.Document.Current.up(a,".dw-suggestion-item",true)||c.set_current(null)});b(this,{template:d,data:this._data[g]});Dynamicweb.Frontend.Document.Current.append(e,
d)}};Dynamicweb.Frontend.SuggestionBox._ie_timeoutID=0;Dynamicweb.Frontend.SuggestionBox._ie_dimension={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};
Dynamicweb.Frontend.SuggestionBox.prototype.show=function(){var a=null,b=this.get_container(),c=this.get_attachTo(),a=function(a){if(a.type=="resize"&&Dynamicweb.Frontend.Document.Current.get_isIE()){Dynamicweb.Frontend.SuggestionBox._ie_timeoutID&&clearTimeout(Dynamicweb.Frontend.SuggestionBox._ie_timeoutID);Dynamicweb.Frontend.SuggestionBox._ie_timeoutID=setTimeout(function(){if(Dynamicweb.Frontend.SuggestionBox._ie_dimension.width!=document.documentElement.clientWidth||Dynamicweb.Frontend.SuggestionBox._ie_dimension.height!=
document.documentElement.clientHeight){Dynamicweb.Frontend.SuggestionBox.hideAll();Dynamicweb.Frontend.SuggestionBox._ie_dimension={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}},10)}else Dynamicweb.Frontend.SuggestionBox.hideAll()};a._dimensions={width:document.body.clientWidth,height:document.body.clientHeight};if(b&&c&&Dynamicweb.Frontend.Document.Current.html(b).length>0){Dynamicweb.Frontend.Document.Current.stopObserving(window,"resize",a);Dynamicweb.Frontend.Document.Current.stopObserving(document.body,
"click",a);Dynamicweb.Frontend.Document.Current.observe(window,"resize",a);Dynamicweb.Frontend.Document.Current.observe(document.body,"click",a);(a=Dynamicweb.Frontend.Document.Current.offset(c))&&Dynamicweb.Frontend.Document.Current.style(b,{display:"block",position:"absolute","z-index":"999",left:a.left+"px",top:a.top+Dynamicweb.Frontend.Document.Current.height(c)-1+"px"})}};
Dynamicweb.Frontend.SuggestionBox.prototype.tryNavigate=function(a){var b=true,c=null;if(this.get_isVisible()){a==40?c=this.next():a==38?c=this.previous():b=false;this.set_current(c);b&&c==null?this.get_attachTo()&&this.updateTextboxValue(this.get_query()):this.updateTextboxValue()}else b=false;return b};
Dynamicweb.Frontend.SuggestionBox.prototype.next=function(){var a=null,b=null;if(this.get_current()==null){b=Dynamicweb.Frontend.Document.Current.select(this.get_container(),".dw-suggestion-item");b!=null&&(a=b[0])}else a=Dynamicweb.Frontend.Document.Current.next(this.get_current(),".dw-suggestion-item");return a};
Dynamicweb.Frontend.SuggestionBox.prototype.previous=function(){var a=null,b=null;if(this.get_current()==null){b=Dynamicweb.Frontend.Document.Current.select(this.get_container(),".dw-suggestion-item");b!=null&&(a=b[b.length-1])}else a=Dynamicweb.Frontend.Document.Current.previous(this.get_current(),".dw-suggestion-item");return a};Dynamicweb.Frontend.SuggestionBox.prototype.hide=function(){var a=this.get_container();a&&Dynamicweb.Frontend.Document.Current.style(a,{display:"none"})};
Dynamicweb.Frontend.SuggestionBox.prototype.updateTextboxValue=function(a){var b="",c=this.get_current(),d=this.get_attachTo();if(d){if(typeof a!="undefined")Dynamicweb.Frontend.Document.Current.value(d,a);else if(c){b=Dynamicweb.Frontend.Document.Current.attribute(c,"data-suggestion-text");Dynamicweb.Frontend.Document.Current.value(d,b&&b.length?b:Dynamicweb.Frontend.Document.Current.text(c))}try{d.focus()}catch(e){}}};
Dynamicweb.Frontend.SuggestionBox.prototype._getTemplate=function(a){var b=null,c=this.get_container();if(c)(b=Dynamicweb.Frontend.Document.Current.down(c,a))&&(b=Dynamicweb.Frontend.Document.Current.clone(b,true));return b};
Dynamicweb.Frontend.SuggestionBox.retrieve=function(a,b){a=a?a.toString():"";if(!window._suggestionBoxes)window._suggestionBoxes=[];if(!window._suggestionBoxes[a]){window._suggestionBoxes[a]=new Dynamicweb.Frontend.SuggestionBox(a,b);window._suggestionBoxes[a].set_itemTemplate(window._suggestionBoxes[a]._getTemplate(".dw-suggestion-item"));window._suggestionBoxes[a].set_emptyListTemplate(window._suggestionBoxes[a]._getTemplate(".dw-no-suggestions"))}return window._suggestionBoxes[a]};
Dynamicweb.Frontend.SuggestionBox.retrieveAll=function(){if(!window._suggestionBoxes)window._suggestionBoxes=[];return window._suggestionBoxes};Dynamicweb.Frontend.SuggestionBox.hideAll=function(){var a=Dynamicweb.Frontend.SuggestionBox.retrieveAll(),b;for(b in a)a[b]&&typeof a[b].hide=="function"&&a[b].hide()};
Dynamicweb.Frontend.SearchResultItemTemplate=function(a){this._container=Dynamicweb.Frontend.Document.Current.element(a);this._isVisible=true;if(this._container){this._container=Dynamicweb.Frontend.Document.Current.clone(this._container,true);this._cleanContainer=Dynamicweb.Frontend.Document.Current.clone(this._container,true)}};Dynamicweb.Frontend.SearchResultItemTemplate.prototype.reset=function(){this._container=Dynamicweb.Frontend.Document.Current.clone(this._cleanContainer,true)};
Dynamicweb.Frontend.SearchResultItemTemplate.prototype.get_container=function(){return this._container};Dynamicweb.Frontend.SearchResultItemTemplate.prototype.get_isVisible=function(){return this._isVisible};Dynamicweb.Frontend.SearchResultItemTemplate.prototype.set_isVisible=function(a){this._isVisible=!!a};
Dynamicweb.Frontend.SearchResultItemTemplate.prototype.field=function(a,b){var c="",d=null;if(a){a=a.toLowerCase();d=Dynamicweb.Frontend.Document.Current.select(this.get_container(),".dw-search-result-"+a);if(d!=null&&d.length>0){d=Dynamicweb.Frontend.Document.Current.element(d[0]);if(Dynamicweb.Frontend.Document.Current.tag(d)=="a")if(typeof b=="undefined")c=Dynamicweb.Frontend.Document.Current.attribute(d,"href");else{c=b;Dynamicweb.Frontend.Document.Current.attribute(d,"href",c)}else if(Dynamicweb.Frontend.Document.Current.tag(d)==
"img")if(typeof b=="undefined")c=Dynamicweb.Frontend.Document.Current.attribute(d,"src");else{c=b;Dynamicweb.Frontend.Document.Current.attribute(d,"src",c)}else if(Dynamicweb.Frontend.Document.Current.tag(d)=="input")if(typeof b=="undefined")c=Dynamicweb.Frontend.Document.Current.attribute(d,"value");else{c=b;Dynamicweb.Frontend.Document.Current.attribute(d,"value",c)}else if(typeof b=="undefined")c=Dynamicweb.Frontend.Document.Current.text(d);else{c=b;Dynamicweb.Frontend.Document.Current.html(d,
c)}}}return c};
Dynamicweb.Frontend.SearchResultsContainer=function(a){var b=null;this._query="";this._data=[];this._container=Dynamicweb.Frontend.Document.Current.element(a);this._emptyListTemplate=this._itemTemplate=null;if(this._container){b=Dynamicweb.Frontend.Document.Current.select(this.get_container(),".dw-search-result");if(b!=null&&b.length>0)this._itemTemplate=new Dynamicweb.Frontend.SearchResultItemTemplate(b[0]);b=Dynamicweb.Frontend.Document.Current.select(this.get_container(),".dw-no-results");if(b!=
null&&b.length>0){this._emptyListTemplate=Dynamicweb.Frontend.Document.Current.clone(b[0],true);Dynamicweb.Frontend.Document.Current.style(this._emptyListTemplate,{display:"block"})}}};Dynamicweb.Frontend.SearchResultsContainer.prototype.get_query=function(){return this._query};Dynamicweb.Frontend.SearchResultsContainer.prototype.set_query=function(a){this._query=a};Dynamicweb.Frontend.SearchResultsContainer.prototype.get_container=function(){return this._container};
Dynamicweb.Frontend.SearchResultsContainer.prototype.get_itemTemplate=function(){return this._itemTemplate};Dynamicweb.Frontend.SearchResultsContainer.prototype.set_itemTemplate=function(a){this._itemTemplate=a};Dynamicweb.Frontend.SearchResultsContainer.prototype.get_emptyListTemplate=function(){return this._emptyListTemplate};Dynamicweb.Frontend.SearchResultsContainer.prototype.set_emptyListTemplate=function(a){this._emptyListTemplate=a};
Dynamicweb.Frontend.SearchResultsContainer.prototype.get_data=function(){if(!this._data)this._data=[];return this._data};
Dynamicweb.Frontend.SearchResultsContainer.prototype.populateResults=function(a,b){var c=null,d=this.get_container(),b=b||function(){};if(d){Dynamicweb.Frontend.Document.Current.html(d,"");if((this._data=a)&&this._data.length>0)for(var e=0;e<this._data.length;e++){this.get_itemTemplate().reset();for(var f in this._data[e])this.get_itemTemplate().field(f,this._data[e][f]);Dynamicweb.Frontend.Document.Current.style(this.get_itemTemplate().get_container(),{display:"block"});c={template:this.get_itemTemplate(),
data:this._data[e]};b(this,c);c.template.get_isVisible()&&Dynamicweb.Frontend.Document.Current.append(d,c.template.get_container())}else this.get_emptyListTemplate()&&Dynamicweb.Frontend.Document.Current.append(d,Dynamicweb.Frontend.Document.Current.clone(this.get_emptyListTemplate(),true))}};
Dynamicweb.Frontend.SearchResultsContainer.retrieve=function(a){a=a?a.toString():"";if(!window._searchContainers)window._searchContainers=[];window._searchContainers[a]||(window._searchContainers[a]=new Dynamicweb.Frontend.SearchResultsContainer(a));return window._searchContainers[a]};Dynamicweb.Frontend.InstantSearchSettings=function(){this._paragraphID=this._pageID=0;this._delay=250;this._isEnabled={}};Dynamicweb.Frontend.InstantSearchSettings.Global=new Dynamicweb.Frontend.InstantSearchSettings;
Dynamicweb.Frontend.InstantSearchSettings.prototype.get_pageID=function(){return this._pageID};Dynamicweb.Frontend.InstantSearchSettings.prototype.set_pageID=function(a){this._pageID=a};Dynamicweb.Frontend.InstantSearchSettings.prototype.get_url=function(){return this._url};Dynamicweb.Frontend.InstantSearchSettings.prototype.set_url=function(a){this._url=a};Dynamicweb.Frontend.InstantSearchSettings.prototype.get_paragraphID=function(){return this._paragraphID};
Dynamicweb.Frontend.InstantSearchSettings.prototype.set_paragraphID=function(a){this._paragraphID=a};Dynamicweb.Frontend.InstantSearchSettings.prototype.get_delay=function(){return this._delay};Dynamicweb.Frontend.InstantSearchSettings.prototype.set_delay=function(a){this._delay=a};
Dynamicweb.Frontend.InstantSearchSettings.prototype.load=function(a){a||(a={});typeof a.pageID!="undefined"&&this.set_pageID(parseInt(a.pageID));typeof a.paragraphID!="undefined"&&this.set_paragraphID(parseInt(a.paragraphID));typeof a.delay!="undefined"&&this.set_delay(parseInt(a.delay));typeof a.url!="undefined"&&this.set_url(a.url)};
Dynamicweb.Frontend.InstantSearchSettings.prototype.setIsEnabled=function(a,b,c){var d=[],e=Dynamicweb.Frontend.Document.Current.id(a),c=!!c;if(e&&b){if(!this._isEnabled)this._isEnabled={};this._isEnabled[b]||(this._isEnabled[b]=[]);if(c&&!this.getIsEnabled(a,b))this._isEnabled[b][this._isEnabled[b].length]=e;else if(!c&&this.getIsEnabled(a,b)){for(a=0;a<this._isEnabled[b].length;a++)this._isEnabled[b][a]!=e&&(d[d.length]=this._isEnabled[b][a]);this._isEnabled[b]=d}}};
Dynamicweb.Frontend.InstantSearchSettings.prototype.getIsEnabled=function(a,b){var c=false,d=Dynamicweb.Frontend.Document.Current.id(a);if(d&&b){if(!this._isEnabled)this._isEnabled={};if(this._isEnabled[b]&&this._isEnabled[b].length)for(var e=0;e<this._isEnabled[b].length;e++)if(this._isEnabled[b][e]==d){c=true;break}}return c};Dynamicweb.Frontend.InstantSearch=function(){};Dynamicweb.Frontend.InstantSearch.QueryEventArgs=function(){this._value="";this._cancel=false};
Dynamicweb.Frontend.InstantSearch.QueryEventArgs.prototype.get_value=function(){return this._value};Dynamicweb.Frontend.InstantSearch.QueryEventArgs.prototype.set_value=function(a){this._value=a};Dynamicweb.Frontend.InstantSearch.QueryEventArgs.prototype.get_cancel=function(){return this._cancel};Dynamicweb.Frontend.InstantSearch.QueryEventArgs.prototype.set_cancel=function(a){this._cancel=!!a};
Dynamicweb.Frontend.InstantSearch.setup=function(a){Dynamicweb.Frontend.InstantSearch._checkFramework();Dynamicweb.Frontend.InstantSearchSettings.Global.load(a)};
Dynamicweb.Frontend.InstantSearch.warmUp=function(a){var b=null,c=null,d=function(){};if(a==null||typeof a=="undefined")a={};if(!a.pageID)a.pageID=Dynamicweb.Frontend.InstantSearchSettings.Global.get_pageID();if(!a.paragraphID)a.paragraphID=Dynamicweb.Frontend.InstantSearchSettings.Global.get_paragraphID();d=a.onComplete||function(){};b=a.url?a.url:Dynamicweb.Frontend.InstantSearchSettings.Global.get_url()?Dynamicweb.Frontend.InstantSearchSettings.Global.get_url():Dynamicweb.Frontend.Document.Current.get_url();
c=new Dynamicweb.Frontend.Hashtable;c.set("ID",a.pageID);c.set("PID",a.paragraphID);c.set("InstantSearchType","WarmUp");Dynamicweb.Frontend.Document.prototype.postAsync(b,{parameters:c.get_data(),onComplete:function(a){d(a)}})};
Dynamicweb.Frontend.InstantSearch.setEnableSuggestions=function(a,b,c){var d=null,e="",f=null;Dynamicweb.Frontend.InstantSearch._checkFramework();f=d=Dynamicweb.Frontend.Document.Current.element(a);if(c&&c.triggerID){f=Dynamicweb.Frontend.Document.Current.element(c.triggerID);Dynamicweb.Frontend.Document.Current.attribute(f,"data-dwtriggers",Dynamicweb.Frontend.Document.Current.id(d))}e=Dynamicweb.Frontend.InstantSearch._getChangeEvent(f);if(d)if(Dynamicweb.Frontend.Document.Current.tag(d).toLowerCase()!=
"input"||Dynamicweb.Frontend.Document.Current.attribute(d,"type").toLowerCase()!="text")Dynamicweb.Frontend.Document.Current.error("Suggested queries can only be enabled on the existing textbox element.");else{Dynamicweb.Frontend.Document.Current.stopObserving(f,e,Dynamicweb.Frontend.InstantSearch._onSuggestWrapper);Dynamicweb.Frontend.InstantSearchSettings.Global.setIsEnabled(d,"suggest",b);c&&c.triggerID&&Dynamicweb.Frontend.InstantSearchSettings.Global.setIsEnabled(c.triggerID,"suggest",b);if(b){if(c&&
(!c.delay||c.delay<0))c.delay=Dynamicweb.Frontend.InstantSearchSettings.Global.get_delay();Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(d),{value:c,suffix:"suggest"});Dynamicweb.Frontend.Document.Current.observe(f,e,Dynamicweb.Frontend.InstantSearch._onSuggestWrapper)}}};
Dynamicweb.Frontend.InstantSearch.setEnableInstantSearch=function(a,b,c){var d=null,e="",f=null;Dynamicweb.Frontend.InstantSearch._checkFramework();f=d=Dynamicweb.Frontend.Document.Current.element(a);if(c&&c.triggerID){f=Dynamicweb.Frontend.Document.Current.element(c.triggerID);Dynamicweb.Frontend.Document.Current.attribute(f,"data-dwtriggers",Dynamicweb.Frontend.Document.Current.id(d))}e=Dynamicweb.Frontend.InstantSearch._getChangeEvent(f);if(d){Dynamicweb.Frontend.Document.Current.stopObserving(f,
e,Dynamicweb.Frontend.InstantSearch._onInstantSearchWrapper);Dynamicweb.Frontend.InstantSearchSettings.Global.setIsEnabled(d,"search",b);if(b){if(c&&(!c.delay||c.delay<0))c.delay=Dynamicweb.Frontend.InstantSearchSettings.Global.get_delay();Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(d),{value:c,suffix:"search"});Dynamicweb.Frontend.Document.Current.observe(f,e,Dynamicweb.Frontend.InstantSearch._onInstantSearchWrapper)}}};
Dynamicweb.Frontend.InstantSearch.suggest=function(a,b){var c="",d=null,e=null,f=null,g=null,i=this,j=f="",l=null,k=f=null,d=false,h=null,m=null,n=null,o=null;b||(b={});l=b.onComplete||function(){};o=b.onItemDataBound||function(){};k=l;n=o;m=b.onBeforeQuery||function(){};if(a){(h=Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(a),{suffix:"suggest"}))||(h={});typeof h.onComplete=="function"&&(k=function(a,b){l(a,b);h.onComplete(a,b)});typeof h.onItemDataBound=="function"&&
(n=function(a,b){o(a,b);h.onItemDataBound(a,b)});typeof h.onBeforeQuery=="function"&&(m=function(a,b){h.onBeforeQuery(a,b)});e=Dynamicweb.Frontend.SuggestionBox.retrieve(h.boxID,Dynamicweb.Frontend.Document.Current.id(a));c=Dynamicweb.Frontend.Document.Current.value(a);if(Dynamicweb.Frontend.InstantSearch._stateChanged(a,"suggest")&&h.boxID){d=true;h.value=c;Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(a),{value:h,suffix:"suggest"})}if(c&&d){g=new Dynamicweb.Frontend.Hashtable;
d=h.url?h.url:Dynamicweb.Frontend.InstantSearchSettings.Global.get_url()?Dynamicweb.Frontend.InstantSearchSettings.Global.get_url():Dynamicweb.Frontend.Document.Current.get_url();j=Dynamicweb.Frontend.Document.Current.attribute(a,"name");g.set("ID",h.pageID?h.pageID:Dynamicweb.Frontend.InstantSearchSettings.Global.get_pageID());g.set("PID",h.paragraphID?h.paragraphID:Dynamicweb.Frontend.InstantSearchSettings.Global.get_paragraphID());g.set("o","json");g.set("InstantSearchType","Suggest");g.set("Caller",
j);(f=Dynamicweb.Frontend.InstantSearch._queryParam("GroupID"))&&g.set("GroupID",f);if(h.request)for(var p in h.request)g.set(p,h.request[p]);f=Dynamicweb.Frontend.Document.Current.up(a,"form");f!=null&&g.merge(Dynamicweb.Frontend.Document.Current.serializeForm(f));g.contains(j)||g.set(j,Dynamicweb.Frontend.Document.Current.value(a));f=new Dynamicweb.Frontend.InstantSearch.QueryEventArgs;f.set_value(g.get(j));f.set_cancel(false);m(this,f);if(f.get_cancel())k(this,{executed:false,data:[],extensionData:{}});
else{g.set(j,f.get_value());h.progressID&&Dynamicweb.Frontend.Document.Current.style(h.progressID,{display:"block"});Dynamicweb.Frontend.Document.prototype.postAsync(d,{parameters:g.get_data(),onComplete:function(a){a=Dynamicweb.Frontend.Document.Current.deserialize(a.responseText);h.progressID&&Dynamicweb.Frontend.Document.Current.style(h.progressID,{display:"none"});if(a){if(e){e.set_query(c);e.populateResults(a.Data,n);e.show()}k(this,{executed:true,data:a.Data,extensionData:i._convertExtensionData(a.ExtensionData)})}else k(this,
{executed:true,data:[],extensionData:i._convertExtensionData(a.ExtensionData)})}})}}else k(this,{executed:false,data:[],extensionData:{}})}else k(this,{executed:false,data:[],extensionData:{}})};
Dynamicweb.Frontend.InstantSearch.search=function(a,b){var c="",d=null,e=null,f=null,g=this,i=e="",d=false,j=null,l=null,k=e=null,f=false,h=null,m=null,n=null,o=null;b||(b={});l=b.onComplete||function(){};o=b.onItemDataBound||function(){};k=l;n=o;m=b.onBeforeQuery||function(){};if(a){d=Dynamicweb.Frontend.Document.Current.tag(a)=="form";(h=Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(a),{suffix:"search"}))||(h={});typeof h.onComplete=="function"&&(k=function(a,
b){l(a,b);h.onComplete(a,b)});typeof h.onItemDataBound=="function"&&(n=function(a,b){o(a,b);h.onItemDataBound(a,b)});typeof h.onBeforeQuery=="function"&&(m=function(a,b){h.onBeforeQuery(a,b)});j=Dynamicweb.Frontend.SearchResultsContainer.retrieve(h.contentID);c=Dynamicweb.Frontend.Document.Current.value(a);if(Dynamicweb.Frontend.InstantSearch._stateChanged(a,"search")&&h.contentID){f=true;h.value=c;Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(a),{value:h,suffix:"search"})}if((c||
d)&&f){f=new Dynamicweb.Frontend.Hashtable;d=h.url?h.url:Dynamicweb.Frontend.InstantSearchSettings.Global.get_url()?Dynamicweb.Frontend.InstantSearchSettings.Global.get_url():Dynamicweb.Frontend.Document.Current.get_url();i=Dynamicweb.Frontend.Document.Current.attribute(a,"name");f.set("ID",h.pageID?h.pageID:Dynamicweb.Frontend.InstantSearchSettings.Global.get_pageID());f.set("PID",h.paragraphID?h.paragraphID:Dynamicweb.Frontend.InstantSearchSettings.Global.get_paragraphID());f.set("o","json");f.set("InstantSearchType",
"Search");(e=Dynamicweb.Frontend.InstantSearch._queryParam("GroupID"))&&f.set("GroupID",e);i&&f.set("Caller",i);if(h.request)for(var p in h.request)f.set(p,h.request[p]);e=Dynamicweb.Frontend.Document.Current.up(a,"form");e!=null&&f.merge(Dynamicweb.Frontend.Document.Current.serializeForm(e));!f.contains(i)&&i&&f.set(i,Dynamicweb.Frontend.Document.Current.value(a));e=new Dynamicweb.Frontend.InstantSearch.QueryEventArgs;e.set_value(f.get(i));e.set_cancel(false);m(this,e);if(e.get_cancel())k(this,{executed:false,
data:[],extensionData:{}});else{f.set(i,e.get_value());h.progressID&&Dynamicweb.Frontend.Document.Current.style(h.progressID,{display:"block"});Dynamicweb.Frontend.Document.prototype.postAsync(d,{parameters:f.get_data(),onComplete:function(a){a=Dynamicweb.Frontend.Document.Current.deserialize(a.responseText);h.progressID&&Dynamicweb.Frontend.Document.Current.style(h.progressID,{display:"none"});if(a){if(j){j.set_query(c);j.populateResults(a.Data,n)}k(this,{executed:true,data:a.Data,extensionData:g._convertExtensionData(a.ExtensionData)})}else k(this,
{executed:true,data:[],extensionData:g._convertExtensionData(a.ExtensionData)})}})}}else k(this,{executed:false,data:[],extensionData:{}})}else k(this,{executed:false,data:[],extensionData:{}})};
Dynamicweb.Frontend.InstantSearch._onSuggestWrapper=function(a){var b=null,c="",b=0,c=null,d=false,e=Dynamicweb.Frontend.Document.Current.eventTarget(a);if(e){(c=Dynamicweb.Frontend.Document.Current.attribute(e,"data-dwtriggers"))&&(e=Dynamicweb.Frontend.Document.Current.element(c));if(e){(c=Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(e),{suffix:"suggest"}))||(c={});if(b=Dynamicweb.Frontend.SuggestionBox.retrieve(c.boxID,Dynamicweb.Frontend.Document.Current.id(e)))(d=
b.tryNavigate(a.keyCode))||b.hide();(b=parseInt(c.timeoutID))&&clearTimeout(b);d||(b=setTimeout(function(){Dynamicweb.Frontend.InstantSearch.suggest(e)},parseInt(c.delay)));c.timeoutID=b;Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(e),{value:c,suffix:"suggest"})}}};
Dynamicweb.Frontend.InstantSearch._onInstantSearchWrapper=function(a,b){var c="",c="",c=0,d=null,e=Dynamicweb.Frontend.Document.Current.eventTarget(a);b&&(e=b);if(e){c=Dynamicweb.Frontend.Document.Current.tag(e);(c=="form"||c=="input"&&Dynamicweb.Frontend.Document.Current.attribute(e,"type")=="submit")&&Dynamicweb.Frontend.Document.Current.stopEvent(a);if(!b)(c=Dynamicweb.Frontend.Document.Current.attribute(e,"data-dwtriggers"))&&(e=Dynamicweb.Frontend.Document.Current.element(c));(d=Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(e),
{suffix:"search"}))||(d={});(c=parseInt(d.timeoutID))&&clearTimeout(c);c=setTimeout(function(){Dynamicweb.Frontend.InstantSearch.search(e)},parseInt(d.delay));d.timeoutID=c;Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(e),{value:d,suffix:"search"})}};
Dynamicweb.Frontend.InstantSearch._stateChanged=function(a,b){var c=true,d="",e="",d=null;if(a&&b){e=Dynamicweb.Frontend.Document.Current.tag(a);d=Dynamicweb.Frontend.Document.Current.attribute(a,"type");if(e=="form"||e=="button")c=true;else if(e=="input"&&(d=="button"||d=="submit"))c=true;else(d=Dynamicweb.Frontend.Document.Current.data(Dynamicweb.Frontend.Document.Current.id(a),{suffix:b}))&&typeof d.value!="undefined"&&(c=d.value.toLowerCase()!=Dynamicweb.Frontend.Document.Current.value(a).toLowerCase())}return c};
Dynamicweb.Frontend.InstantSearch._getChangeEvent=function(a){var b="",c="",c="";if(a){c=Dynamicweb.Frontend.Document.Current.tag(a).toLowerCase();if(c=="input"){c=Dynamicweb.Frontend.Document.Current.attribute(a,"type").toLowerCase();b=c=="text"||c=="password"?"keyup":"click"}else b=c=="select"||c=="textarea"?"change":c=="form"?"submit":"click"}return b};
Dynamicweb.Frontend.InstantSearch._queryParam=function(a){var b="",c=null,c=null;if(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+a+"=([^&#]*)");c=c.exec(window.location.href);c!=null&&(b=decodeURIComponent(c[1].replace(/\+/g," ")))}return b};
Dynamicweb.Frontend.InstantSearch._checkFramework=function(){typeof Prototype=="undefined"&&typeof jQuery=="undefined"?Dynamicweb.Frontend.Document.Current.error("Either Prototype or jQuery is required for the instant search to work."):typeof Prototype!="undefined"&&typeof jQuery!="undefined"&&Dynamicweb.Frontend.Document.Current.error("Prototype and jQuery cannot be used at the same time with the instant search.")};
Dynamicweb.Frontend.InstantSearch._convertExtensionData=function(a){var b={},c="";if(a&&a.length)for(var d=0;d<a.length;d++)if(a[d]!=null&&a[d].Name!=null){c=a[d].Name.toString();if(c.length>0){c=c.length==1?c.toLowerCase():c.substr(0,1).toLowerCase()+c.substr(1);b[c]=a[d].Value}}return b};
